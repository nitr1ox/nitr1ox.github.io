<!DOCTYPE html>
<html lang="fr">
<head>
<meta charset="UTF-8">
<title>NITROX</title>
<style>
html,body{
  margin:0;
  width:100%;
  height:100%;
  overflow:hidden;
  background:black;
  cursor:none;
  font-family:Arial,sans-serif;
}
#f{position:fixed;inset:0;background:red;opacity:0;pointer-events:none;z-index:9}
#c{position:fixed;width:16px;height:16px;border:2px solid red;border-radius:50%;z-index:10;pointer-events:none}
.w{
  position:absolute;width:220px;height:140px;
  background:#c0c0c0;border:2px solid #000;
  box-shadow:4px 4px 0 #000;
}
.t{background:navy;color:#fff;padding:4px;font-size:14px}
.b{height:calc(100% - 26px);display:flex;align-items:center;justify-content:center;
   font-size:28px;font-weight:bold;color:red;background:#fff}
.sh{animation:s .1s infinite}
@keyframes s{
  0%{transform:translate(0,0)}
  25%{transform:translate(4px,-4px)}
  50%{transform:translate(-4px,4px)}
  75%{transform:translate(4px,4px)}
  100%{transform:translate(-4px,-4px)}
}
</style>
</head>
<body>

<div id="f"></div>
<div id="c"></div>

<script>
/* ===== CURSEUR ===== */
let mx=0,my=0,cv=1;
const cur=document.getElementById("c");
document.onmousemove=e=>{
  mx=e.clientX;my=e.clientY;
  cur.style.left=mx+(Math.random()*8-4)+"px";
  cur.style.top=my+(Math.random()*8-4)+"px";
};
setInterval(()=>{cv=!cv;cur.style.display=cv?"block":"none"},700);

/* ===== FENÊTRES ===== */
const ws=[];
function W(x,y){
  const d=document.createElement("div");
  d.className="w";
  d.innerHTML='<div class="t">ERREUR</div><div class="b">NITROX</div>';
  d.x=x??Math.random()*(innerWidth-220);
  d.y=y??Math.random()*(innerHeight-140);
  d.vx=Math.random()*4+2;
  d.vy=Math.random()*4+2;
  d.onmousedown=e=>{
    e.stopPropagation();
    for(let i=0;i<3;i++)W(d.x+Math.random()*50,d.y+Math.random()*50);
  };
  document.body.appendChild(d);
  ws.push(d);
}
for(let i=0;i<8;i++)W();
setInterval(()=>{if(ws.length<140)W()},900);

(function A(){
  ws.forEach(w=>{
    const dx=w.x+110-mx,dy=w.y+70-my;
    const dist=Math.hypot(dx,dy);
    if(dist<180){w.vx+=dx/dist*2;w.vy+=dy/dist*2}
    w.x+=w.vx;w.y+=w.vy;
    if(w.x<0||w.x+220>innerWidth)w.vx*=-1;
    if(w.y<0||w.y+140>innerHeight)w.vy*=-1;
    w.style.left=w.x+"px";w.style.top=w.y+"px";
  });
  requestAnimationFrame(A);
})();

/* ===== AUDIO CHAOS ===== */
let ctx,g,osc,bpm=70,on=0;
const flash=document.getElementById("f");

function start(){
  if(on)return;on=1;
  document.documentElement.requestFullscreen().catch(()=>{});
  ctx=new (AudioContext||webkitAudioContext)();
  g=ctx.createGain();g.gain.value=.15;g.connect(ctx.destination);
  osc=ctx.createOscillator();
  osc.type="sawtooth";osc.frequency.value=50;
  osc.connect(g);osc.start();
  beat();
}
function beat(){
  const i=60000/bpm;
  flash.style.opacity=.6;
  setTimeout(()=>flash.style.opacity=0,i*.3);
  osc.frequency.setValueAtTime(40+Math.random()*25,ctx.currentTime);
  bpm+=1.2;if(bpm>260)bpm=260;
  if(bpm>140)document.body.classList.add("sh");
  setTimeout(beat,i);
}
document.onmousedown=start;

/* gain qui monte avec le temps */
let mg=.15;
setInterval(()=>{
  if(g){mg+=.0008;if(mg>.45)mg=.45;g.gain.value=mg}
},1000);
setInterval(()=>{if(g&&g.gain.value<mg)g.gain.value=mg},300);

/* ===== FAUX BUG VISUEL ===== */
setInterval(()=>{
  document.body.style.filter=
  `blur(${Math.random()*3}px) contrast(${1+Math.random()})`;
},120);

/* ===== SORTIE UNIQUE (OBFUSQUÉE) ===== */
let k="";
document.onkeydown=e=>{
  if(e.key.length===1){
    k=(k+e.key.toLowerCase()).slice(-4);
    if(k===String.fromCharCode(99,97,99,97)){
      document.exitFullscreen().catch(()=>{});
      location.reload();
    }
  }
};

/* blocages */
oncontextmenu=e=>e.preventDefault();
onkeydown=e=>{
  if(["Escape","F11","Tab"].includes(e.key))e.preventDefault();
};
setInterval(()=>{if(!document.fullscreenElement)
document.documentElement.requestFullscreen().catch(()=>{})},1500);
</script>

</body>
</html>
